Step-by-Step Process: Azure Monitor Setup
ðŸ”¹ Step 1: Enable Monitoring for a Resource (e.g., VM)
For a Virtual Machine:

Go to Azure Portal â†’ Virtual Machines â†’ Select VM

Click on Monitoring â†’ Insights

If not enabled, click Enable â†’ Select a Log Analytics Workspace

This installs the Monitoring agent to collect performance/log data.

ðŸ”¹ Step 2: Create a Log Analytics Workspace (if needed)
bash
Copy
Edit
az monitor log-analytics workspace create \
  --resource-group my-rg \
  --workspace-name myLogAnalytics \
  --location eastus
ðŸ”¹ Step 3: Link the Resource to the Workspace
bash
Copy
Edit
az monitor diagnostic-settings create \
  --name vm-diagnostics \
  --resource <VM_RESOURCE_ID> \
  --workspace <LOG_ANALYTICS_WORKSPACE_ID> \
  --metrics '[{"category":"AllMetrics","enabled":true}]' \
  --logs '[{"category":"Syslog","enabled":true}]'
ðŸ”¹ Step 4: View Logs in Azure Monitor
Go to Azure Monitor â†’ Logs

Choose your Workspace

Run KQL (Kusto Query Language) queries

âœ… Example Queries:

kusto
Copy
Edit
Heartbeat
| where TimeGenerated > ago(30m)
kusto
Copy
Edit
Perf
| where ObjectName == "Processor" and CounterName == "% Processor Time"
| summarize avg(CounterValue) by bin(TimeGenerated, 5m)
ðŸ”¹ Step 5: Set Up an Alert Rule
Go to Azure Monitor â†’ Alerts â†’ New Alert Rule

Scope: Select the resource (e.g., VM)

Condition: Example â†’ CPU > 80% for 5 mins

Action Group: Email, SMS, Logic App, Function, etc.

Click Create

ðŸ”¹ Step 6: Create a Dashboard (Optional)
Go to Azure Monitor â†’ Metrics

Add a chart â†’ Select a metric (e.g., CPU)

Pin to dashboard â†’ Customize dashboard view

ðŸ”¹ Step 7: Application Insights (for App Monitoring)
Use for real-time insights into app performance.

bash
Copy
Edit
az monitor app-insights component create \
  --app app-insights-demo \
  --location eastus \
  --resource-group my-rg \
  --application-type web
ðŸ”’ Best Practices
âœ… Enable VM insights and boot diagnostics

âœ… Use action groups for central alert handling

âœ… Set retention in Log Analytics to save cost

âœ… Use Tags for alert targeting across environments

âœ… Use Application Map in App Insights for distributed tracing

ðŸ“¦ Summary Table
Component	Purpose
VM Insights	VM performance monitoring
Log Analytics	Central logging + queries
Diagnostic Settings	Enable resource-level telemetry
Alerts + Action Grps	Notify or auto-remediate issues
Dashboards	Visual monitoring
App Insights	Monitor application performance
